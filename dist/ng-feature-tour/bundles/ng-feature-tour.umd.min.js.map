{"version":3,"sources":["../../../projects/ng-feature-tour/src/lib/ng-feature-tour.model.ts","../../../projects/ng-feature-tour/src/lib/ng-feature-tour.service.ts","../../../projects/ng-feature-tour/src/lib/pipes/identify.pipe.ts","../../../projects/ng-feature-tour/src/lib/pipes/aria-description.pipe.ts","../../../projects/ng-feature-tour/src/lib/pipes/aria-label.pipe.ts","../../../projects/ng-feature-tour/src/lib/components/feature-tour/ng-feature-tour.component.html","../../../projects/ng-feature-tour/src/lib/components/feature-tour/ng-feature-tour.component.ts","../../../projects/ng-feature-tour/src/lib/ng-feature-tour.module.ts"],"names":["EventEnum","this","onChange","EventEmitter","initialize","FeatureTourService","factory","ɵfac","providedIn","IdentifyPipe","prototype","transform","step","prefix","target","pure","AriaDescriptionPipe","title","description","AriaLabelPipe","label","total","index","replace","toString","i0.ɵɵelement","i0.ɵɵclassProp","i0.ɵɵelementStart","i0.ɵɵlistener","i0.ɵɵelementEnd","i0.ɵɵproperty","i0.ɵɵtext","i0.ɵɵtemplate","i0.ɵɵadvance","i0.ɵɵstyleProp","step_r2","bounds","lens","top","width","height","i0.ɵɵclassMapInterpolate1","visible","i0.ɵɵattribute","i0","ɵɵpipeBind3","ctx_r1","setup","a11ty","roleDescription","steps","length","index_r3","i0.ɵɵtextInterpolate","NgFeatureTourComponent","featureTourService","disableStep","enabled","disableTour","event","emitChangeEvent","scrollToTop","window","scrollTo","document","getElementById","offsetTop","emit","getBounds","left","stepRect","getBoundingClientRect","targetRect","modifiers","y","screen","availHeight","push","x","availWidth","join","applyBounds","stepId","targetElement","stepElement","captureFocus","tabable","querySelectorAll","item","setTimeout","focus","enableStep","_this","ngOnInit","subscribe","initialStep","filter","shift","onEscapeHandler","currentStep","_a","close","Escape","isLastStep","stepIndex","isFirstStep","getAriasIdentifiers","previous","currentStepIndex","Previous","next","Next","finish","Finish","abort","Abort","ɵɵdirectiveInject","selectors","hostBindings","rf","ctx","$event","ɵɵresolveDocument","NgFeatureTourModule","imports","BrowserModule","A11yModule","declarations","exports"],"mappings":"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","sourcesContent":["export enum EventEnum {\n  Start = 'START',\n  Next = 'NEXT',\n  Previous = 'PREVIOUS',\n  Abort = 'ABORT',\n  Finish = 'FINISH',\n  Escape = 'ESCAPE',\n}\n\nexport interface Event {\n  event: EventEnum;\n  step: Step;\n}\n\nexport interface Step {\n  target: string;\n  title: string;\n  description: string;\n  enabled?: boolean;\n  visible?: boolean;\n  bounds?: StepBounds;\n}\n\nexport interface LensBounds {\n  left: number;\n  top: number;\n  width: number;\n  height: number;\n}\n\nexport interface StepBounds {\n  left: number;\n  top: number;\n  modifiers: string;\n  lens: LensBounds;\n}\n\nexport interface Setup {\n  a11ty: {\n    roleDescription: string;\n  };\n  initialStep: string;\n  controls: {\n    abort: string;\n    previous: string;\n    next: string;\n    done: string;\n  };\n}\n","import { Injectable, EventEmitter } from '@angular/core';\n\nimport { Event, Setup } from './ng-feature-tour.model';\n\n@Injectable({ providedIn: 'root' })\nexport class FeatureTourService {\n  onChange: EventEmitter<Event>;\n  initialize: EventEmitter<Setup>;\n\n  constructor() {\n    this.onChange = new EventEmitter<Event>();\n    this.initialize = new EventEmitter<Setup>();\n  }\n}\n","import { Pipe, PipeTransform } from '@angular/core';\nimport { Step } from '../ng-feature-tour.model';\n\n@Pipe({ name: 'identify' })\nexport class IdentifyPipe implements PipeTransform {\n  transform(step: Step, prefix: string = 'ft-step'): string {\n    return `${prefix}-${step.target}`;\n  }\n}\n","import { Pipe, PipeTransform } from '@angular/core';\nimport { Step } from '../ng-feature-tour.model';\n\n@Pipe({ name: 'ariaDescription' })\nexport class AriaDescriptionPipe implements PipeTransform {\n  transform(step: Step): string {\n    return `${step.title}. ${step.description}.`;\n  }\n}\n","import { Pipe, PipeTransform } from '@angular/core';\n\n@Pipe({ name: 'ariaLabel' })\nexport class AriaLabelPipe implements PipeTransform {\n  transform(label: string, total: number, index: number): string {\n    index = index + 1;\n\n    return label\n      .replace('{total}', total.toString())\n      .replace('{index}', index.toString());\n  }\n}\n","<div class=\"ft-wrapper\" *ngIf=\"enabled\" cdkTrapFocus>\n  <div *ngFor=\"let step of steps; let index = index\" [hidden]=\"!step.enabled\">\n    <div class=\"ft-scape-handler\" (click)=\"onEscapeHandler()\"></div>\n    <div\n      class=\"ft-lens\"\n      [style.left.px]=\"step.bounds?.lens.left\"\n      [style.top.px]=\"step.bounds?.lens.top\"\n      [style.width.px]=\"step.bounds?.lens.width\"\n      [style.height.px]=\"step.bounds?.lens.height\"\n    ></div>\n    <div\n      aria-modal=\"true\"\n      role=\"dialog\"\n      class=\"ft-step {{ step.bounds?.modifiers }}\"\n      [id]=\"step | identify\"\n      [attr.aria-roledescription]=\"step | ariaDescription\"\n      [attr.aria-label]=\"\n        setup.a11ty.roleDescription | ariaLabel: steps.length:index\n      \"\n      [style.left.px]=\"step.bounds?.left\"\n      [style.top.px]=\"step.bounds?.top\"\n      [style.visibility]=\"step.visible ? 'visible' : 'hidden'\"\n    >\n      <h2 class=\"ft-step-title\">{{ step.title }}</h2>\n      <div class=\"ft-step-description\">{{ step.description }}</div>\n\n      <div class=\"ft-step-bullet-list\">\n        <span\n          *ngFor=\"let step of steps\"\n          class=\"ft-step-bullet\"\n          [class.is-current]=\"step.enabled\"\n        ></span>\n      </div>\n      <div class=\"ft-step-controls\">\n        <div class=\"ft-step-abort\">\n          <button\n            type=\"button\"\n            tabindex=\"0\"\n            *ngIf=\"!isLastStep(index)\"\n            (click)=\"abort(step)\"\n            [innerHTML]=\"setup.controls.abort\"\n          ></button>\n        </div>\n        <div class=\"ft-step-navigation\">\n          <button\n            type=\"button\"\n            tabindex=\"0\"\n            *ngIf=\"!isFirstStep(index)\"\n            (click)=\"previous(step, index)\"\n            [innerHTML]=\"setup.controls.previous\"\n          ></button>\n          <button\n            type=\"button\"\n            tabindex=\"0\"\n            *ngIf=\"!isLastStep(index)\"\n            (click)=\"next(step, index)\"\n            [innerHTML]=\"setup.controls.next\"\n          ></button>\n          <button\n            type=\"button\"\n            tabindex=\"0\"\n            *ngIf=\"isLastStep(index)\"\n            (click)=\"finish(step)\"\n            [innerHTML]=\"setup.controls.done\"\n          ></button>\n        </div>\n      </div>\n    </div>\n  </div>\n</div>\n","import { Component, OnInit, HostListener, Input } from '@angular/core';\n\nimport {\n  Step,\n  EventEnum,\n  StepBounds,\n  Setup,\n} from '../../ng-feature-tour.model';\nimport { FeatureTourService } from '../../ng-feature-tour.service';\n\n@Component({\n  selector: 'ng-feature-tour',\n  templateUrl: './ng-feature-tour.component.html',\n  styleUrls: ['./ng-feature-tour.component.scss'],\n})\nexport class NgFeatureTourComponent implements OnInit {\n  @Input()\n  steps: Step[];\n\n  enabled: boolean;\n\n  setup: Setup;\n\n  constructor(private featureTourService: FeatureTourService) {}\n\n  private disableStep(step: Step): void {\n    step.enabled = false;\n    step.visible = false;\n  }\n\n  private disableTour(step: Step, event: EventEnum): void {\n    this.enabled = false;\n    this.emitChangeEvent(step, event);\n  }\n\n  private scrollToTop(step: Step): void {\n    window.scrollTo(0, document.getElementById(step.target).offsetTop - 16);\n  }\n\n  private emitChangeEvent(step: Step, event: EventEnum): void {\n    this.featureTourService.onChange.emit({ event, step });\n  }\n\n  private getBounds(step: HTMLElement, target: HTMLElement): StepBounds {\n    const margin = 32;\n    const stepRect = step.getBoundingClientRect();\n    const targetRect = target.getBoundingClientRect();\n\n    let left: number;\n    let top: number;\n    let modifiers: string[] = [];\n\n    // axis y\n    if (\n      targetRect.y >\n      screen.availHeight - (targetRect.y + targetRect.height)\n    ) {\n      modifiers.push('to-top');\n      top = targetRect.y - stepRect.height - margin;\n    } else {\n      modifiers.push('to-bottom');\n      top = targetRect.y + targetRect.height + margin;\n    }\n\n    // axis x\n    if (targetRect.x > screen.availWidth / 2) {\n      modifiers.push('to-right');\n      left = targetRect.x + targetRect.width - stepRect.width;\n    } else {\n      modifiers.push('to-left');\n      left = targetRect.x;\n    }\n\n    return {\n      left,\n      top,\n      modifiers: modifiers.join(' '),\n      lens: {\n        left: targetRect.left,\n        top: targetRect.top,\n        width: targetRect.width,\n        height: targetRect.height,\n      },\n    };\n  }\n\n  private applyBounds(step: Step): void {\n    const stepId = `ft-step-${step.target}`;\n    const targetElement = document.getElementById(step.target);\n    const stepElement = document.getElementById(stepId);\n\n    step.bounds = this.getBounds(stepElement, targetElement);\n  }\n\n  private captureFocus(step: Step): void {\n    const stepId = `ft-step-${step.target}`;\n    const tabable = document.querySelectorAll(`#${stepId} [tabindex]`).item(0);\n\n    setTimeout(() => {\n      (<HTMLElement>tabable).focus();\n    }, 1);\n  }\n\n  private enableStep(step: Step): void {\n    this.scrollToTop(step);\n    this.enabled = true;\n    step.enabled = true;\n\n    // render delay trick\n    setTimeout(() => {\n      step.visible = true;\n      this.applyBounds(step);\n      this.captureFocus(step);\n    }, 1);\n  }\n\n  ngOnInit(): void {\n    if (!this.steps || this.steps.length === 0) {\n      throw 'NgFeatureTourComponent: no steps provided';\n    }\n\n    this.featureTourService.initialize.subscribe((setup: Setup) => {\n      const initialStep = this.steps\n        .filter((step) => step.target === setup.initialStep)\n        .shift();\n\n      if (!initialStep) {\n        throw `NgFeatureTourComponent: target \"${setup.initialStep}\" not found`;\n      }\n\n      this.setup = setup;\n      this.enableStep(initialStep);\n    });\n  }\n\n  @HostListener('document:keydown.escape', ['$event'])\n  onEscapeHandler(event?: KeyboardEvent) {\n    if (!this.steps) {\n      return;\n    }\n\n    const currentStep = this.steps.filter(({ enabled }) => enabled).shift();\n\n    if (!currentStep) {\n      return;\n    }\n\n    this.close(currentStep);\n    this.emitChangeEvent(currentStep, EventEnum.Escape);\n  }\n\n  close(step: Step): void {\n    step.enabled = false;\n    step.visible = false;\n    this.enabled = false;\n  }\n\n  isLastStep(stepIndex: number): boolean {\n    return stepIndex === this.steps.length - 1;\n  }\n\n  isFirstStep(stepIndex: number): boolean {\n    return stepIndex === 0;\n  }\n\n  getAriasIdentifiers(target: string): string {\n    return `ft-title-${target} ft-description-${target}`;\n  }\n\n  previous(currentStep: Step, currentStepIndex: number): void {\n    const step = this.steps[currentStepIndex - 1];\n\n    this.disableStep(currentStep);\n    this.enableStep(step);\n    this.emitChangeEvent(step, EventEnum.Previous);\n  }\n\n  next(currentStep: Step, currentStepIndex: number): void {\n    const step = this.steps[currentStepIndex + 1];\n\n    this.disableStep(currentStep);\n    this.enableStep(step);\n    this.emitChangeEvent(step, EventEnum.Next);\n  }\n\n  finish(currentStep: Step): void {\n    this.disableStep(currentStep);\n    this.disableTour(currentStep, EventEnum.Finish);\n  }\n\n  abort(currentStep: Step): void {\n    this.disableStep(currentStep);\n    this.disableTour(currentStep, EventEnum.Abort);\n  }\n}\n","import { BrowserModule } from '@angular/platform-browser';\nimport { NgModule } from '@angular/core';\nimport { A11yModule } from '@angular/cdk/a11y';\n\nimport { NgFeatureTourComponent } from './components/feature-tour/ng-feature-tour.component';\n\nimport { AriaDescriptionPipe } from './pipes/aria-description.pipe';\nimport { AriaLabelPipe } from './pipes/aria-label.pipe';\nimport { IdentifyPipe } from './pipes/identify.pipe';\n\n@NgModule({\n  declarations: [\n    NgFeatureTourComponent,\n    AriaDescriptionPipe,\n    AriaLabelPipe,\n    IdentifyPipe,\n  ],\n  imports: [BrowserModule, A11yModule],\n  exports: [NgFeatureTourComponent],\n})\nexport class NgFeatureTourModule {}\n"]}